- name: awkward_UnionArray_flatten_combine
  specializations:
    - name: awkward_UnionArray64_flatten_combine_64
      args:
        - totags: List[int8_t]
        - toindex: List[int64_t]
        - tooffsets: List[int64_t]
        - fromtags: List[int8_t]
        - fromtagsoffset: int64_t
        - fromindex: List[int64_t]
        - fromindexoffset: int64_t
        - length: int64_t
        - offsetsraws: List[List[int64_t]]
        - offsetsoffsets: List[int64_t]
    - name: awkward_UnionArray32_flatten_combine_64
      args:
        - totags: List[int8_t]
        - toindex: List[int64_t]
        - tooffsets: List[int64_t]
        - fromtags: List[int8_t]
        - fromtagsoffset: int64_t
        - fromindex: List[int32_t]
        - fromindexoffset: int64_t
        - length: int64_t
        - offsetsraws: List[List[int64_t]]
        - offsetsoffsets: List[int64_t]
    - name: awkward_UnionArrayU32_flatten_combine_64
      args:
        - totags: List[int8_t]
        - toindex: List[int64_t]
        - tooffsets: List[int64_t]
        - fromtags: List[int8_t]
        - fromtagsoffset: int64_t
        - fromindex: List[uint32_t]
        - fromindexoffset: int64_t
        - length: int64_t
        - offsetsraws: List[List[int64_t]]
        - offsetsoffsets: List[int64_t]
  inparams: ['fromtags', 'fromtagsoffset', 'fromindex', 'fromindexoffset', 'length', 'offsetsraws', 'offsetsoffsets']
  outparams: ['totags', 'toindex', 'tooffsets']
  definition: |
    def awkward_UnionArray_flatten_combine(
        totags,
        toindex,
        tooffsets,
        fromtags,
        fromtagsoffset,
        fromindex,
        fromindexoffset,
        length,
        offsetsraws,
        offsetsoffsets,
    ):
        tooffsets[0] = 0
        k = 0
        for i in range(length):
            tag = fromtags[fromtagsoffset + i]
            idx = fromindex[fromindexoffset + i]
            start = offsetsraws[tag][offsetsoffsets[tag] + idx]
            stop = offsetsraws[tag][(offsetsoffsets[tag] + idx) + 1]
            tooffsets[i + 1] = tooffsets[i] + (stop - start)
            for j in range(start, stop):
                totags[k] = tag
                toindex[k] = j
                k = k + 1
