- name: awkward_ListArray_getitem_jagged_apply
  specializations:
    - name: awkward_ListArray64_getitem_jagged_apply_64
      args:
        - tooffsets: List[int64_t]
        - tocarry: List[int64_t]
        - slicestarts: List[int64_t]
        - slicestartsoffset: int64_t
        - slicestops: List[int64_t]
        - slicestopsoffset: int64_t
        - sliceouterlen: int64_t
        - sliceindex: List[int64_t]
        - sliceindexoffset: int64_t
        - sliceinnerlen: int64_t
        - fromstarts: List[int64_t]
        - fromstartsoffset: int64_t
        - fromstops: List[int64_t]
        - fromstopsoffset: int64_t
        - contentlen: int64_t
    - name: awkward_ListArrayU32_getitem_jagged_apply_64
      args:
        - tooffsets: List[int64_t]
        - tocarry: List[int64_t]
        - slicestarts: List[int64_t]
        - slicestartsoffset: int64_t
        - slicestops: List[int64_t]
        - slicestopsoffset: int64_t
        - sliceouterlen: int64_t
        - sliceindex: List[int64_t]
        - sliceindexoffset: int64_t
        - sliceinnerlen: int64_t
        - fromstarts: List[uint32_t]
        - fromstartsoffset: int64_t
        - fromstops: List[uint32_t]
        - fromstopsoffset: int64_t
        - contentlen: int64_t
    - name: awkward_ListArray32_getitem_jagged_apply_64
      args:
        - tooffsets: List[int64_t]
        - tocarry: List[int64_t]
        - slicestarts: List[int64_t]
        - slicestartsoffset: int64_t
        - slicestops: List[int64_t]
        - slicestopsoffset: int64_t
        - sliceouterlen: int64_t
        - sliceindex: List[int64_t]
        - sliceindexoffset: int64_t
        - sliceinnerlen: int64_t
        - fromstarts: List[int32_t]
        - fromstartsoffset: int64_t
        - fromstops: List[int32_t]
        - fromstopsoffset: int64_t
        - contentlen: int64_t
  inparams: ['slicestarts', 'slicestartsoffset', 'slicestops', 'slicestopsoffset', 'sliceouterlen', 'sliceindex', 'sliceindexoffset', 'sliceinnerlen', 'fromstarts', 'fromstartsoffset', 'fromstops', 'fromstopsoffset', 'contentlen']
  outparams: ['tooffsets', 'tocarry']
  definition: |
    def awkward_ListArray_getitem_jagged_apply(
        tooffsets,
        tocarry,
        slicestarts,
        slicestartsoffset,
        slicestops,
        slicestopsoffset,
        sliceouterlen,
        sliceindex,
        sliceindexoffset,
        sliceinnerlen,
        fromstarts,
        fromstartsoffset,
        fromstops,
        fromstopsoffset,
        contentlen,
    ):
        k = 0
        for i in range(sliceouterlen):
            slicestart = slicestarts[slicestartsoffset + i]
            slicestop = slicestops[slicestopsoffset + i]
            tooffsets[i] = float(k)
            if slicestart != slicestop:
                if slicestop < slicestart:
                    raise ValueError("jagged slice's stops[i] < starts[i]")
                if slicestop > sliceinnerlen:
                    raise ValueError("jagged slice's offsets extend beyond its content")
                start = int(fromstarts[fromstartsoffset + i])
                stop = int(fromstops[fromstopsoffset + i])
                if stop < start:
                    raise ValueError("stops[i] < starts[i]")
                if (start != stop) and (stop > contentlen):
                    raise ValueError("stops[i] > len(content)")
                count = stop - start
                for j in range(slicestart, slicestop):
                    index = int(sliceindex[sliceindexoffset + j])
                    if index < 0:
                        index += count
                    if not ((0 <= index) and (index < count)):
                        raise ValueError("index out of range")
                    tocarry[k] = start + index
                    k = k + 1
            tooffsets[i + 1] = float(k)
  tests:
    - args:
        tooffsets: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
        tocarry: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
        slicestarts: [2, 0, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1]
        slicestartsoffset: 0
        slicestops: [3, 1, 3, 2, 3, 1, 2, 3]
        slicestopsoffset: 0
        sliceouterlen: 3
        sliceindex: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
        sliceindexoffset: 0
        sliceinnerlen: 10
        fromstarts: [1, 2, 3, 4, 5, 6]
        fromstartsoffset: 0
        fromstops: [3, 4, 5, 6, 7, 8]
        fromstopsoffset: 0
        contentlen: 10
      successful: True
      results:
        tooffsets: [0.0, 1.0, 2.0, 3.0]
        tocarry: [1, 2, 3]
    - args:
        tooffsets: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
        tocarry: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
        slicestarts: [1, 0, 0, 0, 1, 1, 0, 1, 1, 0, 1, 0, 1, 0, 1]
        slicestartsoffset: 1
        slicestops: [8, 4, 5, 6, 5, 5, 7]
        slicestopsoffset: 1
        sliceouterlen: 3
        sliceindex: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
        sliceindexoffset: 0
        sliceinnerlen: 10
        fromstarts: [1, 2, 3, 4, 5, 6]
        fromstartsoffset: 1
        fromstops: [3, 4, 5, 6, 7, 8]
        fromstopsoffset: 1
        contentlen: 10
      successful: True
      results:
        tooffsets: [0.0, 4.0, 9.0, 15.0]
        tocarry: [2, 2, 2, 2, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4, 4]
