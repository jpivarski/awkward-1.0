- name: awkward_IndexedArray_getitem_adjust_outindex
  specializations:
    - name: awkward_IndexedArray_getitem_adjust_outindex_64
      args:
        - tomask: List[int8_t]
        - toindex: List[int64_t]
        - tononzero: List[int64_t]
        - fromindex: List[int64_t]
        - fromindexoffset: int64_t
        - fromindexlength: int64_t
        - nonzero: List[int64_t]
        - nonzerooffset: int64_t
        - nonzerolength: int64_t
  inparams: ['fromindex', 'fromindexoffset', 'fromindexlength', 'nonzero', 'nonzerooffset', 'nonzerolength']
  outparams: ['tomask', 'toindex', 'tononzero']
  definition: |
    def awkward_IndexedArray_getitem_adjust_outindex(
        tomask,
        toindex,
        tononzero,
        fromindex,
        fromindexoffset,
        fromindexlength,
        nonzero,
        nonzerooffset,
        nonzerolength,
    ):
        j = 0
        k = 0
        for i in range(fromindexlength):
            fromval = fromindex[fromindexoffset + i]
            tomask[i] = fromval < 0
            if fromval < 0:
                toindex[k] = -1
                k = k + 1
            else:
                if (j < nonzerolength) and (fromval == nonzero[nonzerooffset + j]):
                    tononzero[j] = fromval + (k - j)
                    toindex[k] = j
                    j = j + 1
                    k = k + 1
  tests:
    - args:
        tomask: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
        toindex: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
        tononzero: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
        fromindex: [1, 0, 0, 1, 1, 1, 0, 0, 1, 0, 1, 0, 1, 1]
        fromindexoffset: 1
        fromindexlength: 4
        nonzero: [2, 3, 6, 5, 3, 7, 9, 5, 4]
        nonzerooffset: 0
        nonzerolength: 4
      successful: True
      results:
        tomask: [False, False, False, False]
        toindex: []
        tononzero: []
    - args:
        tomask: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
        toindex: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
        tononzero: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
        fromindex: [1, 1, 2, 2, 0, 2, 0, 2, 1, 1]
        fromindexoffset: 0
        fromindexlength: 3
        nonzero: [2, 5, 3, 4, 7, 6, 3, 4, 5]
        nonzerooffset: 0
        nonzerolength: 3
      successful: True
      results:
        tomask: [False, False, False]
        toindex: [0]
        tononzero: [2]
