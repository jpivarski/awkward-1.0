- name: awkward_ListArray_getitem_jagged_numvalid
  specializations:
    - name: awkward_ListArray_getitem_jagged_numvalid_64
      args:
        - numvalid: List[int64_t]
        - slicestarts: List[int64_t]
        - slicestartsoffset: int64_t
        - slicestops: List[int64_t]
        - slicestopsoffset: int64_t
        - length: int64_t
        - missing: List[int64_t]
        - missingoffset: int64_t
        - missinglength: int64_t
  inparams: ['slicestarts', 'slicestartsoffset', 'slicestops', 'slicestopsoffset', 'length', 'missing', 'missingoffset', 'missinglength']
  outparams: ['numvalid']
  definition: |
    def awkward_ListArray_getitem_jagged_numvalid(
        numvalid,
        slicestarts,
        slicestartsoffset,
        slicestops,
        slicestopsoffset,
        length,
        missing,
        missingoffset,
        missinglength,
    ):
        numvalid[0] = 0
        for i in range(length):
            slicestart = slicestarts[slicestartsoffset + i]
            slicestop = slicestops[slicestopsoffset + i]
            if slicestart != slicestop:
                if slicestop < slicestart:
                    raise ValueError("jagged slice's stops[i] < starts[i]")
                if slicestop > missinglength:
                    raise ValueError("jagged slice's offsets extend beyond its content")
                for j in range(slicestart, slicestop):
                    numvalid[0] = numvalid[0] + 1 if missing[missingoffset + j] >= 0 else 0
  tests:
    - args:
        numvalid: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
        slicestarts: [2, 0, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1]
        slicestartsoffset: 0
        slicestops: [3, 1, 3, 2, 3, 1, 2, 3]
        slicestopsoffset: 0
        length: 3
        missing: [1, 0, 0, 1, 1, 1, 0, 0, 1, 0, 1, 0, 1, 1]
        missingoffset: 1
        missinglength: 10
      successful: True
      results:
        numvalid: [3]
    - args:
        numvalid: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
        slicestarts: [2, 0, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1]
        slicestartsoffset: 0
        slicestops: [3, 1, 3, 2, 3, 1, 2, 3]
        slicestopsoffset: 0
        length: 3
        missing: [1, 1, 2, 2, 0, 2, 0, 2, 1, 1]
        missingoffset: 0
        missinglength: 10
      successful: True
      results:
        numvalid: [3]
    - args:
        numvalid: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
        slicestarts: [1, 0, 0, 0, 1, 1, 0, 1, 1, 0, 1, 0, 1, 0, 1]
        slicestartsoffset: 1
        slicestops: [8, 4, 5, 6, 5, 5, 7]
        slicestopsoffset: 1
        length: 3
        missing: [1, 0, 0, 1, 1, 1, 0, 0, 1, 0, 1, 0, 1, 1]
        missingoffset: 1
        missinglength: 10
      successful: True
      results:
        numvalid: [15]
    - args:
        numvalid: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
        slicestarts: [1, 0, 0, 0, 1, 1, 0, 1, 1, 0, 1, 0, 1, 0, 1]
        slicestartsoffset: 1
        slicestops: [8, 4, 5, 6, 5, 5, 7]
        slicestopsoffset: 1
        length: 3
        missing: [1, 1, 2, 2, 0, 2, 0, 2, 1, 1]
        missingoffset: 0
        missinglength: 10
      successful: True
      results:
        numvalid: [15]
