# BSD 3-Clause License; see https://github.com/scikit-hep/awkward-1.0/blob/master/LICENSE

from __future__ import absolute_import

import sys
import os
import json

import pytest
import numpy

import awkward1

def test_fromfile():
    array = awkward1.from_json('tests/samples/test-record-array.json')
    assert awkward1.to_list(array) == [
        [{'x': 1.1, 'y': []}],
        [{'x': 2.2, 'y': [1]}],
        [{'x': 3.3, 'y': [1, 2]}],
        [{'x': 4.4, 'y': [1, 2, 3]}],
        [{'x': 5.5, 'y': [1, 2, 3, 4]}],
        [{'x': 6.6, 'y': [1, 2, 3, 4, 5]}]]

    array = awkward1.from_json('tests/samples/test.json')

    assert awkward1.to_list(array) == [47.8712, 1.89325, 5.0, 'inf', '-inf',
        [21.1765, 8.36586, 29.0269, 4.149, 5.0, 2.68624e-11, 0.0593972, 0.0603743],
        [32.8902, 3.0, 7.0, 0.162448, 1.59408, 0.862678],
        [[[ 0.0311627,    0.0820037,   0.0714865,    0.0122187,  -0.0702538],
          [ 0.000626321, -2.06042e-06, 0.00897404,  -4.44436e-06, 2.2186e-07,
            5.92208e-08, -7.96081e-08, 1.86396e-05,  1.22249e-09, 9.49398e-08,
           -4.94616e-06, -4.01517e-07, 9.04106e-08, -5.40489e-10, 1.00434e-06],
          [ 0.971217],
          [ 0.305714, 0.0, 'NaN', 'NaN', 0.0, 2.0, 0.278014]],
         [[ 0.0440594,    0.0793784,   0.0859708,    0.00393219,  0.113113],
          [ 0.000626321, -2.06042e-06, 0.00897404,  -4.44436e-06, 2.2186e-07,
            5.92208e-08, -7.96081e-08, 1.86396e-05,  1.22249e-09, 9.49398e-08,
           -4.94616e-06, -4.01517e-07, 9.04106e-08, -5.40489e-10, 1.00434e-06],
          [ 0.942343],
          [ 0.305714, 0.0, 'NaN', 'NaN', 0.0, 2.0, 0.278014]],
         [[-0.312833,     1.02502,    -0.132586,     0.00861097, -0.193043],
          [ 0.000626321, -2.06042e-06, 0.00897404,  -4.44436e-06, 2.2186e-07,
            5.92208e-08, -7.96081e-08, 1.86396e-05,  1.22249e-09, 9.49398e-08,
           -4.94616e-06, -4.01517e-07, 9.04106e-08, -5.40489e-10, 1.00434e-06],
          [ 0.606197],
          [ 0.687111, 4.07223, 0.20831, 0.190906, 0.61576, 3.0, 0.202447]],
         [[-0.264986, 1.37488, 0.0311171, 0.0153541, 0.0304456],
          [ 0.00015658,  -5.15104e-07, 0.00224351,  -2.22218e-06, 1.1093e-07,
            5.92208e-08, -3.98041e-08, 9.31981e-06,  1.22249e-09, 9.49398e-08,
           -2.47308e-06, -2.00758e-07, 9.04106e-08, -5.40489e-10, 1.00434e-06],
          [ 0.57175],
          [ 0.441745, 18.8806, 0.0234775, 0.0794154, 2.80106, 2.0, 0.485516]],
         [[-0.209367,     0.393041,    0.0275814,  -0.00099008, -0.134433],
          [ 0.000626321, -2.06042e-06, 0.00897404, -4.44436e-06, 2.2186e-07,
            5.92208e-08, -7.96081e-08, 1.86396e-05, 1.22249e-09, 9.49398e-08,
           -4.94616e-06, -4.01517e-07, 9.04106e-08, -5.40489e-10, 1.00434e-06],
          [0.0510539],
          [0.441745, 18.8806, 0.0234775, 0.0794154, 2.80106, 2.0, 0.485516]],
         [[-0.190491,     1.2959,     -0.0844926,    0.0561922,  -0.239596],
          [ 0.000626321, -2.06042e-06, 0.00897404,  -4.44436e-06, 2.2186e-07,
            5.92208e-08, -7.96081e-08, 1.86396e-05,  1.22249e-09, 9.49398e-08,
           -4.94616e-06, -4.01517e-07, 9.04106e-08, -5.40489e-10, 1.00434e-06],
          [0.579789],
          [0.465224, 6.06779, 0.054115, 0.030099, 2.45542, 2.0, 0.174715]],
         [[-0.0509223,    0.442866,    0.0248813,    0.0171021,   0.0968987],
          [ 0.000626321, -2.06042e-06, 0.00897404,  -4.44436e-06, 2.2186e-07,
            5.92208e-08, -7.96081e-08, 1.86396e-05,  1.22249e-09, 9.49398e-08,
           -4.94616e-06, -4.01517e-07, 9.04106e-08, -5.40489e-10, 1.00434e-06],
          [0.0457482],
          [0.465224, 6.06779, 0.054115, 0.030099, 2.45542, 2.0, 0.174715]]]]
