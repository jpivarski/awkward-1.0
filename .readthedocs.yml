version: 2

sphinx:
  configuration: docs/conf.py

build:
  os: ubuntu-22.04
  tools:
    python: "3.10"
  jobs:
    pre_build:
      - pip install requests pyyaml
      # Generate required code / metadata
      - python3 dev/generate-kernel-docs.py
      - python3 dev/copy-cpp-headers.py
      # Download built artefacts
      - python3 dev/download-github-artefact.py scikit-hep/awkward-1.0 jupyter-cache -d docs/_build/.jupyter_cache
      - python3 dev/download-github-artefact.py scikit-hep/awkward-1.0 awkward-cpp-wasm -d docs/lite/pypi
      - python3 dev/download-github-artefact.py scikit-hep/awkward-1.0 awkward -d docs/lite/pypi

python:
  install:
    # Don't install the conda env, as we won't run any notebooks!
    - requirements: docs/requirements.txt
